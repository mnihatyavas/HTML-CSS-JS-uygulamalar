<!DOCTYPE html>
<html>
<head>
    <meta charset="iso:8859-9 Türkçe">
    <title>C1c54c2.html: Hýzlý Promise.all vaat kýlýfla 3 asenkron bekletmeli fetch-try-catch-finally ve çaðýran yalýn göster() örneði.</title>
    <style>
        html {background-color: #152;}
        body {
            background-color: #a97;
            max-width: 80%;
            min-width: 880px;
            padding: 20px;
            margin: 2em auto;
            border: 5px solid tomato;
            text-align: center;}
        h3 {margin:0;}
        img {border: 2px solid navy; margin: 2px;}
        p {font-size: 22px; color: DarkGreen;}
    </style>
</head>
<body>
    <!-- Fetch'li vaat (>>>python -m http.server) ve (localhost:8000) gerektirir. -->
    <h3>F12-konsolu aç (Asenkron bekletmeli fetch)</h3>

    <script>
        göster();

        async function göster() {
            let kahve = getir ("resim/kahve.jpg", "blob");
            let çay = getir ("resim/çay.jpg", "blob");
            let yorum = getir ("C1c53d.txt", "text");

            let deðerler = await Promise.all ([kahve, çay, yorum]); // Hýzlý asenkron bekletme...
            console.log (deðerler);

            let yurelNesnesi1 = URL.createObjectURL (deðerler [0]);
            let yurelNesnesi2 = URL.createObjectURL (deðerler [1]);
            let yorumMetni = deðerler [2];

            let resim1 = document.createElement ("img");
            let resim2 = document.createElement ("img");
            resim1.src = yurelNesnesi1; resim1.title = "Bir fincan kahvenin 40 yýl hatýrý olurmuþ."; resim1.alt = "Resim: kahve.jpg";
            resim2.src = yurelNesnesi2; resim2.title = "Bir fincan çay, içeni 40 gr zayýflatýrmýþ."; resim2.alt = "Resim: çay.jpg";
            document.body.appendChild (resim1);
            document.body.appendChild (resim2);

            let paragraf = document.createElement ("p");
            paragraf.textContent = yorumMetni; paragraf.title = "Metindeki Türkçe harfler gösterilmediðinden ascii-utf8 kullanýlmýþtýr."
            document.body.appendChild(paragraf);
        } // afunc sonu...

        async function getir (yurel, tip) {
            try {
                let yanýt = await fetch (yurel);
                if (! yanýt.ok) {throw new Error (`Fetch hatasý! Statü no: ${yanýt.status}`);
                }else if (tip === "blob") {return await yanýt.blob();
                }else if (tip === "text") {return await yanýt.text();}
                return "tanýmsýz tip";
            }catch (hata) {console.error (hata);
            }finally {console.log (`"${yurel}" dosyasýný getirme tamamlandý.`); };
        } // afunc sonu...
    </script>
</body>
</html>